<form name="reportForm" class="form-horizontal" role="form">
<main-layout>

<headline>{{ "reports.title" | translate }}</headline>
<actions>
</actions>

<content>
<div class="wdReportsView" ng-init="reportType='FacilityUsage'">

<!--<div class="row smallMarginBottom">
    <p>{{ "reports.help.summary" | translate }}</p>
    <ul>
        <li>{{ "reports.help.bullet1" | translate }}</li>
        <li>{{ "reports.help.bullet2" | translate }}</li>
    </ul>
</div>-->

<div class="row">
    <label class="radiobutton-label">
        <input type="radio" ng-model="reportType" value="FacilityUsage"/>
        Täyttöasteraportti
    </label>
    <br>
    <label class="radiobutton-label">
        <input type="radio" ng-model="reportType" value="MaxUtilization"/>
        Keskimääräinen maksimitäyttöaste
    </label>
    <br>
    <label class="radiobutton-label">
        <input type="radio" ng-model="reportType" value="HubsAndFacilities"/>
        Alueiden ja pysäköintilaitosten perustiedot
    </label>
</div>

<div class="row smallMarginBottom">
    <div class="row" ng-show="reportType == 'FacilityUsage'"><h3>Täyttöasteraportti</h3><p>Raportilla voi tarkastella useamman tai yksittäisen pysäköintipaikan vapaita paikkoja eri ajanhetkinä.</p></div>
    <div class="row" ng-show="reportType == 'MaxUtilization'"><h3>Keskimääräinen maksimitäyttöaste</h3><p>Raportti kertoo maksimitäyttöasteen prosentteina arki-la-su-tarkkuudella valitulta aikaväliltä.</p></div>
    <div class="row" ng-show="reportType == 'HubsAndFacilities'"><h3>Alueiden ja pysäköintilaitosten perustiedot</h3><p>Raporttiin haetaan kaikkien järjestelmään tallennetut alueiden ja pysäköintipaikkojen perustiedot.</p></div>
</div>

<div ng-show="reportType != 'HubsAndFacilities'" ng-init="report.startDate=1 +'.'+ (date.getMonth()+1) +'.'+ date.getFullYear();
        report.endDate=date.getDate() +'.'+ (date.getMonth()+1) +'.'+ date.getFullYear()">
    <div class="row">
        <label>Päivä(t) *</label>
    </div>
    <div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <input class="form-control dateInput" type="text" ng-model="report.startDate" ng-required="reportType != 'HubsAndFacilities'">
                -
                <input class="form-control dateInput" type="text" ng-model="report.endDate"">
            </div>
        </div>
    </div>
</div>

<div ng-show="reportType == 'FacilityUsage'">
  <div class="row">
    <label ng-init="report.interval=60">
      Raportoinnin tarkuus
    </label>
  </div>
  <div class="row">
    <div class="column3 first-column">
      <div class="form-group">
        <select class="form-control dateInput" ng-model="report.interval" convert-to-number>
          <option value="5">5 min</option>
          <option value="10">10 min</option>
          <option value="15">15 min</option>
          <option value="30">30 min</option>
          <option value="60">60 min</option>
        </select>
      </div>
    </div>
  </div>
</div>

<div ng-show="reportType != 'HubsAndFacilities'">
  <div class="row">
    <label>{{"operators.label" | translate}}</label>
  </div>
  <!--TODO option "all"
  <div class="row">
    <div class="column3 first-column">
      <div class="form-group">
        <select ng-model="report.operators" ng-options="operator.id as operator.name.fi for operator in allOperators">
          <option value="">Kaikki</option>
        </select>
      </div>
    </div>
  </div>-->
  <div class="row">
    <div class="column3 first-column">
      <div class="form-group">
        <ui-select ng-model="report.operators" theme="bootstrap" ng-disabled="disabled" reset-search-input="true"
                   name="operator" show-errors ng-required="mandatory">
          <ui-select-match placeholder="Kaikki">{{$select.selected.name.fi}}</ui-select-match>
          <ui-select-choices repeat="operator.id as operator in allOperators | filter: {name: {fi: $select.search}}">
            <div ng-bind-html="operator.name.fi | highlight: $select.search"></div>
          </ui-select-choices>
        </ui-select>
      </div>
    </div>
  </div>
</div>

<div ng-show="reportType != 'HubsAndFacilities'">
    <div class="row">
        <label>{{"facilities.list.usages" | translate}}</label>
    </div>
    <div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <!--TODO option for "all"
                <select ng-model="report.usages" ng-options="usage.id as usage.label for usage in usages">
                    <option value="">Kaikki</option>
                </select>-->
                <ui-select ng-model="report.usages" theme="bootstrap" ng-disabled="disabled" reset-search-input="true"
                           name="usage" show-errors ng-required="mandatory">
                    <ui-select-match placeholder="Kaikki">{{$select.selected.label}}</ui-select-match>
                    <ui-select-choices repeat="usage.id as usage in usages | filter: {label: $select.search}">
                        <div ng-bind-html="usage.label | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
    </div>
</div>

<div ng-show="reportType != 'HubsAndFacilities'" ng-init="report.capacityTypes=['CAR']">
    <div class="row">
        <label>{{"facilities.capacity.type" | translate}}</label>
    </div>
    <div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <ui-select ng-model="report.capacityTypes" theme="bootstrap" ng-disabled="disabled" reset-search-input="true"
                           name="capacity" show-errors ng-required="mandatory">
                    <ui-select-match placeholder="Henkilöauto">{{$select.selected.label}}</ui-select-match>
                    <ui-select-choices repeat="capacity.id as capacity in capacityTypes | filter: {label: $select.search}">
                        <div ng-bind-html="capacity.label | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
    </div>
</div>

<div ng-show="reportType != 'HubsAndFacilities'">
    <div class="row">
        <label>Alueet</label>
    </div>
    <!--<div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <select multiple ng-model="report.hubs" ng-options="hub.id as hub.name.fi for hub in allHubs">
                    <option value="">Kaikki</option>
                </select>
            </div>
        </div>
    </div>-->
    <div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <ui-select multiple ng-model="report.hubs" theme="bootstrap" ng-disabled="disabled" name="hub" reset-search-input="true">
                    <ui-select-match placeholder="Kaikki alueet valittuna">{{$item.name.fi}}</ui-select-match>
                    <ui-select-choices repeat="hub.id as hub in allHubs | filter: {name: {fi: $select.search}}">
                        <div ng-bind-html="hub.name.fi | highlight: $select.search">moi</div>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
    </div>
</div>

<div ng-show="reportType != 'HubsAndFacilities'">
    <div class="row">
        <label>{{"facilities.title" | translate}}</label>
    </div>
    <!--<div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <select multiple ng-model="report.facilities" ng-options="facility.id as facility.name.fi for facility in allFacilities">
                    <option value="">Kaikki</option>
                </select>
            </div>
        </div>
    </div>-->
    <div class="row">
        <div class="column3 first-column">
            <div class="form-group">
                <ui-select multiple ng-model="report.facilities" theme="bootstrap" ng-disabled="disabled" name="facility" reset-search-input="true">
                    <ui-select-match placeholder="Kaikki pysäköintipaikat valittuna">{{$item.name.fi}}</ui-select-match>
                    <ui-select-choices repeat="facility.id as facility in allFacilities | filter: {name: {fi: $select.search}}">
                        <div ng-bind-html="facility.name.fi | highlight: $select.search">moi</div>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
    </div>
</div>

<div class="row smallMargin">
    <p>Tässä menee hetki!<br>
        <button type="submit" class="btn btn-xs" ng-disabled="reportForm.$invalid" ng-click="generate(reportType + '.xlsx', report)">{{ "reports.action.do" | translate }}</button>
    </p>
</div>

</div>
</content>
</main-layout>
</form>